completed routines, need to loop and test convergence
